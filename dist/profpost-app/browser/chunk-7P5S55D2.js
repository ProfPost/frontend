import{a as et,b as pe,c as St,d as ue,e as he,f as it,g as fe,i as _e,j as nt,k as rt,l as ot,m as at,n as st,o as ct,p as lt,q as dt,r as mt,s as pt,u as ge,x as be}from"./chunk-N65FLJWE.js";import{$ as se,A as ee,Ca as D,G as ie,J as ne,K as re,Z as oe,_ as ae,a as Yt,b as Jt,ba as ce,c as qt,ca as le,f as Wt,g as Gt,h as Kt,i as Qt,j as Xt,p as Zt,r as te}from"./chunk-H3CLWMWT.js";import{a as X,g as V,h as Ut,i as Z,j as zt,k as $t,n as H,p as tt}from"./chunk-ZAGS7POU.js";import{c as B,d as O,f as u,g as C,h as J,i as w,j as de,k as me}from"./chunk-EJJBCPAK.js";import{$ as F,Aa as It,Ab as n,B as Pt,Bb as p,Cb as _,Da as kt,Db as g,Fb as I,Ib as S,Ic as Vt,Jc as R,Kb as M,Lb as At,Lc as Q,Mb as Tt,Nc as jt,Oc as L,Ub as $,Va as Et,Vb as s,Wb as K,Xb as v,Ya as c,Yb as Nt,Za as P,Zb as Ht,_b as Bt,ac as b,ca as Mt,dc as k,ec as E,fa as l,gc as Ft,j as bt,ja as f,kb as vt,l as wt,la as Ot,nb as d,oc as Lt,qb as Ct,ra as Dt,rb as m,rc as Y,sa as x,sb as z,ta as y,vb as Rt,zb as r}from"./chunk-3G4MZ7MC.js";var ut=class e{isSidebarActive=!1;toggleSidebar(){this.isSidebarActive=!this.isSidebarActive}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=f({type:e,selectors:[["app-reader-layout"]],standalone:!0,features:[b],decls:28,vars:2,consts:[[1,"container-layout"],[1,"sidebar"],[1,"logo"],["src","assets/images/intro-nav/logo.png","alt","Logo"],["routerLink","publications-catalog","routerLinkActive","active"],[1,"fas","fa-home"],["routerLink","subscriptions","routerLinkActive","active"],[1,"fas","fa-credit-card"],["routerLink","playlist","routerLinkActive","active"],[1,"fas","fa-play-circle"],["routerLink","search","routerLinkActive","active"],[1,"fas","fa-search"],[1,"main-content"],[1,"sidebar-toggle-btn",3,"click"],[1,"fas","fa-bars"]],template:function(t,o){t&1&&(p(0,"app-navbar"),r(1,"div",0)(2,"div",1)(3,"div",2),p(4,"img",3),n(),r(5,"nav")(6,"ul")(7,"li")(8,"a",4),p(9,"i",5),s(10," Inicio "),n()(),r(11,"li")(12,"a",6),p(13,"i",7),s(14," Suscripciones "),n()(),r(15,"li")(16,"a",8),p(17,"i",9),s(18," Playlist "),n()(),r(19,"li")(20,"a",10),p(21,"i",11),s(22," Buscar "),n()()()()(),r(23,"div",12)(24,"button",13),S("click",function(){return o.toggleSidebar()}),p(25,"i",14),n(),p(26,"router-outlet"),n()(),p(27,"app-footer")),t&2&&(c(2),z("collapsed",!o.isSidebarActive))},dependencies:[L,Yt,Jt,Ut,zt,$t],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;margin:0}.container-layout[_ngcontent-%COMP%]{display:flex;background-color:#e5e8d8}.main-content[_ngcontent-%COMP%]{background-color:#e5e8d8}.sidebar[_ngcontent-%COMP%]{width:200px;height:100vh;background-color:#f8f9f4;padding:20px;box-shadow:2px 0 5px #0000001a;position:fixed;left:0;top:0;transform:translate(0);transition:transform .3s ease;z-index:1000}.sidebar.collapsed[_ngcontent-%COMP%]{transform:translate(-100%)}.sidebar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;display:block;margin:0 auto 20px}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;margin:0;list-style-type:none}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px;font-size:16px;color:#333;cursor:pointer;border-radius:8px;text-decoration:none;transition:background-color .3s}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;margin-right:10px;color:#087443}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#e5e8d8}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#d0e7de;color:#087443}.main-content[_ngcontent-%COMP%]{flex-grow:1;padding:20px;margin-left:200px;transition:margin-left .3s ease}.sidebar.collapsed[_ngcontent-%COMP%] ~ .main-content[_ngcontent-%COMP%]{margin-left:0}.sidebar-toggle-btn[_ngcontent-%COMP%]{position:fixed;top:15px;left:15px;background-color:#087443;color:#fff;border:none;padding:10px;border-radius:4px;cursor:pointer;z-index:1001}.sidebar-toggle-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px}.sidebar-toggle-btn[_ngcontent-%COMP%]:hover{box-shadow:0 0 5px #087443}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{transform:translate(-100%)}.sidebar.collapsed[_ngcontent-%COMP%]{transform:translate(0)}.main-content[_ngcontent-%COMP%]{margin-left:0}.sidebar-toggle-btn[_ngcontent-%COMP%]{display:block}}"]})};var j=class e{baseURL=`${H.baseURL}/purchases`;http=l(X);createPurchase(i){return this.http.post(this.baseURL,i)}initiatePurchase(i){return this.http.post(this.baseURL,i)}getPurchaseHistoryByUserId(i){return this.http.get(`${this.baseURL}/user/${i}`)}static \u0275fac=function(t){return new(t||e)};static \u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"})};var ht=class e{baseURL=`${H.baseURL}/checkout`;http=l(X);createCheckout(i,t,o){let a=`${this.baseURL}/create?purchaseId=${i}&returnUrl=${encodeURIComponent(t)}&cancelUrl=${encodeURIComponent(o)}`;return this.http.post(a,{})}captureOrder(i){let t=`${this.baseURL}/capture?orderId=${i}`;return this.http.post(t,{})}static \u0275fac=function(t){return new(t||e)};static \u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"})};function ye(e,i){e&1&&(r(0,"div",1)(1,"p"),s(2,"Procesando su pago, por favor espere..."),n()())}var W=class e{subscriptionService=l(et);donationService=l(he);purchaseService=l(j);checkoutService=l(ht);authService=l(tt);snackBar=l(D);router=l(Z);route=l(V);loading=!0;ngOnInit(){this.route.queryParams.subscribe(i=>{let t=i.token;t?this.captureOrder(t):localStorage.getItem("subscriptionData")?this.initiateSubscription():localStorage.getItem("donationData")&&this.initiateDonation()})}initiateSubscription(){let i=JSON.parse(localStorage.getItem("subscriptionData")||"{}");this.subscriptionService.subscribe(i).subscribe({next:t=>{localStorage.setItem("subscriptionResponse",JSON.stringify(t)),this.createPurchase(t.subscriptionId,t.userId,i.months)},error:()=>{this.loading=!1,this.showSnackBar("Error en la suscripci\xF3n"),this.clearlocalstorage()}})}initiateDonation(){let i=JSON.parse(localStorage.getItem("donationData")||"{}"),o=JSON.parse(localStorage.getItem("profpost_auth")||"{}").id;this.donationService.createDonation(i).subscribe({next:a=>{localStorage.setItem("donationResponse",JSON.stringify(a)),this.createDonation(a.id,o)}})}createPurchase(i,t,o){this.purchaseService.createPurchase({user_id:t,subscription_id:i,months:o}).subscribe({next:a=>{localStorage.setItem("purchaseResponse",JSON.stringify(a)),this.createCheckout(a.id)},error:()=>{this.loading=!1,this.showSnackBar("Error al redirigir al crear la compra"),this.clearlocalstorage()}})}createDonation(i,t){this.purchaseService.initiatePurchase({user_id:t,donation_id:i}).subscribe({next:o=>{localStorage.setItem("purchaseResponse",JSON.stringify(o)),this.createCheckout(o.id)},error:()=>{this.loading=!1,this.showSnackBar("Error al redirigir al crear la compra"),this.clearlocalstorage()}})}createCheckout(i){let t=H.paypalReturnUrl,o=H.paypalReturnUrl;this.checkoutService.createCheckout(i,t,o).subscribe({next:a=>{window.location.href=a.paypalUrl,this.loading=!1},error:()=>{this.loading=!1,this.showSnackBar("Error al redirigir a PayPal"),this.clearlocalstorage()}})}captureOrder(i){let o=JSON.parse(localStorage.getItem("profpost_auth")||"{}").id;this.checkoutService.captureOrder(i).subscribe({next:a=>{a.completed?(this.clearlocalstorage(),this.router.navigate(["/reader/order/"+o]),this.showSnackBar("Felicidades! Gracias por tu compra <3")):(this.router.navigate(["/reader/search"]),this.clearlocalstorage(),this.showSnackBar("Lo sentimos, no pudiste terminar la compra"))},error:()=>{this.router.navigate(["/reader/search"]),this.showSnackBar("Error al capturar la compra"),this.showSnackBar("Lo sentimos, no pudiste terminar la compra"),this.clearlocalstorage()}})}showSnackBar(i){this.snackBar.open(i,"Cerrar",{duration:3e3})}clearlocalstorage(){localStorage.removeItem("selectedUser"),localStorage.removeItem("selectedPlan"),localStorage.removeItem("subscriptionData"),localStorage.removeItem("purchaseResponse"),localStorage.removeItem("subscriptionResponse")}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=f({type:e,selectors:[["app-purchases"]],standalone:!0,features:[b],decls:1,vars:1,consts:[["class","loading-screen",4,"ngIf"],[1,"loading-screen"]],template:function(t,o){t&1&&d(0,ye,3,0,"div",0),t&2&&m("ngIf",o.loading)},dependencies:[R],styles:[".loading-screen[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;background-color:#000000b3;color:#fff;font-size:1.5em}"]})};function Pe(e,i){e&1&&(r(0,"div",12),s(1," El nombre es obligatorio. "),n())}var G=class e{playlist={name:""};playlistId=null;playlistService=l(it);snackBar=l(D);router=l(Z);activatedRoute=l(V);constructor(){}ngOnInit(){this.activatedRoute.params.subscribe(i=>{this.playlistId=i.id,this.playlistId&&this.loadPlaylist()})}loadPlaylist(){this.playlistId&&this.playlistService.getPlaylistById(this.playlistId).subscribe({next:i=>{this.playlist.name=i.name},error:i=>{console.error("Error al cargar la playlist:",i),this.showSnackBar("Error al cargar la playlist")}})}onSubmit(){this.playlist.name?this.playlistId?this.playlistService.updatePlaylist(this.playlistId,this.playlist).subscribe({next:i=>{this.showSnackBar("Playlist actualizada exitosamente"),this.router.navigate(["/reader/playlist"])},error:i=>{console.error("Error al actualizar la playlist:",i),this.showSnackBar("No se pudo actualizar la playlist. Intenta de nuevo.")}}):this.playlistService.createPlaylist(this.playlist).subscribe({next:i=>{this.showSnackBar("Playlist creada exitosamente"),this.router.navigate(["/reader/playlist"])},error:i=>{console.error("Error al crear la playlist:",i),this.showSnackBar("No se pudo crear la playlist. Intenta de nuevo.")}}):this.showSnackBar("El nombre de la playlist es obligatorio")}cancel(){this.router.navigate(["/reader/playlist"])}showSnackBar(i){this.snackBar.open(i,"Cerrar",{duration:3e3})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=f({type:e,selectors:[["app-playlist-form"]],standalone:!0,features:[b],decls:17,vars:3,consts:[["playlistForm","ngForm"],["name","ngModel"],[1,"create-playlist-container"],[1,"header"],[3,"ngSubmit"],[1,"form-group"],["for","name"],["type","text","id","name","name","name","required","","placeholder","Nombre de la playlist",3,"ngModelChange","ngModel"],["class","error-message",4,"ngIf"],[1,"button-group"],["type","submit",3,"disabled"],["type","button",3,"click"],[1,"error-message"]],template:function(t,o){if(t&1){let a=I();r(0,"div",2)(1,"div",3)(2,"h2"),s(3,"Crear Playlist"),n()(),r(4,"form",4,0),S("ngSubmit",function(){return x(a),y(o.onSubmit())}),r(6,"div",5)(7,"label",6),s(8,"Nombre de la Playlist"),n(),r(9,"input",7,1),Bt("ngModelChange",function(N){return x(a),Ht(o.playlist.name,N)||(o.playlist.name=N),y(N)}),n(),d(11,Pe,2,0,"div",8),n(),r(12,"div",9)(13,"button",10),s(14," Guardar Playlist "),n(),r(15,"button",11),S("click",function(){return x(a),y(o.cancel())}),s(16,"Cancelar"),n()()()()}if(t&2){let a=$(5),h=$(10);c(9),Nt("ngModel",o.playlist.name),c(2),m("ngIf",h.invalid&&h.touched),c(2),m("disabled",a.invalid)}},dependencies:[L,R,te,Xt,qt,Wt,Gt,Zt,Qt,Kt],styles:[".create-playlist-container[_ngcontent-%COMP%]{max-width:600px;margin:50px auto;padding:30px;background-color:#e5e8d8;border-radius:10px;box-shadow:0 4px 12px #0000001a;display:flex;flex-direction:column;min-height:70vh}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;color:#000;margin-bottom:20px;font-weight:600;text-align:center}form[_ngcontent-%COMP%]{width:100%;flex-grow:1}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;color:#333;margin-bottom:8px;display:block}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px;font-size:16px;border:1px solid #ccc;border-radius:8px;box-sizing:border-box;background-color:#fff;transition:border-color .3s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#087443;outline:none}.error-message[_ngcontent-%COMP%]{color:#f44336;font-size:14px;margin-top:5px}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease}.button-group[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#087443;color:#fff}.button-group[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background-color:#45a049}.button-group[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.button-group[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.button-group[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]:hover{background-color:#d32f2f}@media (max-width: 768px){.create-playlist-container[_ngcontent-%COMP%]{min-height:60vh;padding:20px}}@media (max-width: 480px){.create-playlist-container[_ngcontent-%COMP%]{min-height:50vh;padding:15px;margin:20px auto}}"]})};var Me=["mat-sort-header",""],Oe=["*"];function De(e,i){if(e&1){let t=I();r(0,"div",2),S("@arrowPosition.start",function(){x(t);let a=M();return y(a._disableViewStateAnimation=!0)})("@arrowPosition.done",function(){x(t);let a=M();return y(a._disableViewStateAnimation=!1)}),p(1,"div",3),r(2,"div",4),p(3,"div",5)(4,"div",6)(5,"div",7),n()()}if(e&2){let t=M();m("@arrowOpacity",t._getArrowViewState())("@arrowPosition",t._getArrowViewState())("@allowChildren",t._getArrowDirectionState()),c(2),m("@indicator",t._getArrowDirectionState()),c(),m("@leftPointer",t._getArrowDirectionState()),c(),m("@rightPointer",t._getArrowDirectionState())}}var ve=new Mt("MAT_SORT_DEFAULT_OPTIONS"),xt=(()=>{class e{get direction(){return this._direction}set direction(t){this._direction=t}constructor(t){this._defaultOptions=t,this._initializedStream=new wt(1),this.sortables=new Map,this._stateChanges=new bt,this.start="asc",this._direction="",this.disabled=!1,this.sortChange=new It,this.initialized=this._initializedStream}register(t){this.sortables.set(t.id,t)}deregister(t){this.sortables.delete(t.id)}sort(t){this.active!=t.id?(this.active=t.id,this.direction=t.start?t.start:this.start):this.direction=this.getNextSortDirection(t),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(t){if(!t)return"";let o=t?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear,a=Ie(t.start||this.start,o),h=a.indexOf(this.direction)+1;return h>=a.length&&(h=0),a[h]}ngOnInit(){this._initializedStream.next()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete(),this._initializedStream.complete()}static{this.\u0275fac=function(o){return new(o||e)(P(ve,8))}}static{this.\u0275dir=Ot({type:e,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{active:[0,"matSortActive","active"],start:[0,"matSortStart","start"],direction:[0,"matSortDirection","direction"],disableClear:[2,"matSortDisableClear","disableClear",Y],disabled:[2,"matSortDisabled","disabled",Y]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],standalone:!0,features:[vt,Dt]})}}return e})();function Ie(e,i){let t=["asc","desc"];return e=="desc"&&t.reverse(),i||t.push(""),t}var T=re.ENTERING+" "+ne.STANDARD_CURVE,U={indicator:B("indicator",[C("active-asc, asc",u({transform:"translateY(0px)"})),C("active-desc, desc",u({transform:"translateY(10px)"})),w("active-asc <=> active-desc",O(T))]),leftPointer:B("leftPointer",[C("active-asc, asc",u({transform:"rotate(-45deg)"})),C("active-desc, desc",u({transform:"rotate(45deg)"})),w("active-asc <=> active-desc",O(T))]),rightPointer:B("rightPointer",[C("active-asc, asc",u({transform:"rotate(45deg)"})),C("active-desc, desc",u({transform:"rotate(-45deg)"})),w("active-asc <=> active-desc",O(T))]),arrowOpacity:B("arrowOpacity",[C("desc-to-active, asc-to-active, active",u({opacity:1})),C("desc-to-hint, asc-to-hint, hint",u({opacity:.54})),C("hint-to-desc, active-to-desc, desc, hint-to-asc, active-to-asc, asc, void",u({opacity:0})),w("* => asc, * => desc, * => active, * => hint, * => void",O("0ms")),w("* <=> *",O(T))]),arrowPosition:B("arrowPosition",[w("* => desc-to-hint, * => desc-to-active",O(T,J([u({transform:"translateY(-25%)"}),u({transform:"translateY(0)"})]))),w("* => hint-to-desc, * => active-to-desc",O(T,J([u({transform:"translateY(0)"}),u({transform:"translateY(25%)"})]))),w("* => asc-to-hint, * => asc-to-active",O(T,J([u({transform:"translateY(25%)"}),u({transform:"translateY(0)"})]))),w("* => hint-to-asc, * => active-to-asc",O(T,J([u({transform:"translateY(0)"}),u({transform:"translateY(-25%)"})]))),C("desc-to-hint, asc-to-hint, hint, desc-to-active, asc-to-active, active",u({transform:"translateY(0)"})),C("hint-to-desc, active-to-desc, desc",u({transform:"translateY(-25%)"})),C("hint-to-asc, active-to-asc, asc",u({transform:"translateY(25%)"}))]),allowChildren:B("allowChildren",[w("* <=> *",[me("@*",de(),{optional:!0})])])},ke=(()=>{class e{constructor(){this.changes=new bt}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ce=(()=>{class e{get sortActionDescription(){return this._sortActionDescription}set sortActionDescription(t){this._updateSortActionDescription(t)}constructor(t,o,a,h,N,Se,xe,yt){this._intl=t,this._changeDetectorRef=o,this._sort=a,this._columnDef=h,this._focusMonitor=N,this._elementRef=Se,this._ariaDescriber=xe,this._showIndicatorHint=!1,this._viewState={},this._arrowDirection="",this._disableViewStateAnimation=!1,this.arrowPosition="after",this.disabled=!1,this._sortActionDescription="Sort",yt?.arrowPosition&&(this.arrowPosition=yt?.arrowPosition),this._handleStateChanges()}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._updateArrowDirection(),this._setAnimationTransitionState({toState:this._isSorted()?"active":this._arrowDirection}),this._sort.register(this),this._sortButton=this._elementRef.nativeElement.querySelector(".mat-sort-header-container"),this._updateSortActionDescription(this._sortActionDescription)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{let o=!!t;o!==this._showIndicatorHint&&(this._setIndicatorHintVisible(o),this._changeDetectorRef.markForCheck())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._rerenderSubscription.unsubscribe(),this._sortButton&&this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription)}_setIndicatorHintVisible(t){this._isDisabled()&&t||(this._showIndicatorHint=t,this._isSorted()||(this._updateArrowDirection(),this._showIndicatorHint?this._setAnimationTransitionState({fromState:this._arrowDirection,toState:"hint"}):this._setAnimationTransitionState({fromState:"hint",toState:this._arrowDirection})))}_setAnimationTransitionState(t){this._viewState=t||{},this._disableViewStateAnimation&&(this._viewState={toState:t.toState})}_toggleOnInteraction(){this._sort.sort(this),(this._viewState.toState==="hint"||this._viewState.toState==="active")&&(this._disableViewStateAnimation=!0)}_handleClick(){this._isDisabled()||this._sort.sort(this)}_handleKeydown(t){!this._isDisabled()&&(t.keyCode===32||t.keyCode===13)&&(t.preventDefault(),this._toggleOnInteraction())}_isSorted(){return this._sort.active==this.id&&(this._sort.direction==="asc"||this._sort.direction==="desc")}_getArrowDirectionState(){return`${this._isSorted()?"active-":""}${this._arrowDirection}`}_getArrowViewState(){let t=this._viewState.fromState;return(t?`${t}-to-`:"")+this._viewState.toState}_updateArrowDirection(){this._arrowDirection=this._isSorted()?this._sort.direction:this.start||this._sort.start}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?this._sort.direction=="asc"?"ascending":"descending":"none"}_renderArrow(){return!this._isDisabled()||this._isSorted()}_updateSortActionDescription(t){this._sortButton&&(this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription),this._ariaDescriber?.describe(this._sortButton,t)),this._sortActionDescription=t}_handleStateChanges(){this._rerenderSubscription=Pt(this._sort.sortChange,this._sort._stateChanges,this._intl.changes).subscribe(()=>{this._isSorted()&&(this._updateArrowDirection(),(this._viewState.toState==="hint"||this._viewState.toState==="active")&&(this._disableViewStateAnimation=!0),this._setAnimationTransitionState({fromState:this._arrowDirection,toState:"active"}),this._showIndicatorHint=!1),!this._isSorted()&&this._viewState&&this._viewState.toState==="active"&&(this._disableViewStateAnimation=!1,this._setAnimationTransitionState({fromState:"active",toState:this._arrowDirection})),this._changeDetectorRef.markForCheck()})}static{this.\u0275fac=function(o){return new(o||e)(P(ke),P(Lt),P(xt,8),P("MAT_SORT_HEADER_COLUMN_DEF",8),P(ie),P(kt),P(ee,8),P(ve,8))}}static{this.\u0275cmp=f({type:e,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(o,a){o&1&&S("click",function(){return a._handleClick()})("keydown",function(N){return a._handleKeydown(N)})("mouseenter",function(){return a._setIndicatorHintVisible(!0)})("mouseleave",function(){return a._setIndicatorHintVisible(!1)}),o&2&&(Ct("aria-sort",a._getAriaSortAttribute()),z("mat-sort-header-disabled",a._isDisabled()))},inputs:{id:[0,"mat-sort-header","id"],arrowPosition:"arrowPosition",start:"start",disabled:[2,"disabled","disabled",Y],sortActionDescription:"sortActionDescription",disableClear:[2,"disableClear","disableClear",Y]},exportAs:["matSortHeader"],standalone:!0,features:[vt,b],attrs:Me,ngContentSelectors:Oe,decls:4,vars:7,consts:[[1,"mat-sort-header-container","mat-focus-indicator"],[1,"mat-sort-header-content"],[1,"mat-sort-header-arrow"],[1,"mat-sort-header-stem"],[1,"mat-sort-header-indicator"],[1,"mat-sort-header-pointer-left"],[1,"mat-sort-header-pointer-right"],[1,"mat-sort-header-pointer-middle"]],template:function(o,a){o&1&&(At(),r(0,"div",0)(1,"div",1),Tt(2),n(),d(3,De,6,6,"div",2),n()),o&2&&(z("mat-sort-header-sorted",a._isSorted())("mat-sort-header-position-before",a.arrowPosition==="before"),Ct("tabindex",a._isDisabled()?null:0)("role",a._isDisabled()?null:"button"),c(3),Rt(a._renderArrow()?3:-1))},styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-container,[mat-sort-header].cdk-program-focused .mat-sort-header-container{border-bottom:solid 1px currentColor}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-container::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-sort-header-content{text-align:center;display:flex;align-items:center}.mat-sort-header-position-before{flex-direction:row-reverse}.mat-sort-header-arrow{height:12px;width:12px;min-width:12px;position:relative;display:flex;color:var(--mat-sort-arrow-color, var(--mat-app-on-surface));opacity:0}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}.mat-sort-header-stem{background:currentColor;height:10px;width:2px;margin:auto;display:flex;align-items:center}.cdk-high-contrast-active .mat-sort-header-stem{width:0;border-left:solid 2px}.mat-sort-header-indicator{width:100%;height:2px;display:flex;align-items:center;position:absolute;top:0;left:0}.mat-sort-header-pointer-middle{margin:auto;height:2px;width:2px;background:currentColor;transform:rotate(45deg)}.cdk-high-contrast-active .mat-sort-header-pointer-middle{width:0;height:0;border-top:solid 2px;border-left:solid 2px}.mat-sort-header-pointer-left,.mat-sort-header-pointer-right{background:currentColor;width:6px;height:2px;position:absolute;top:0}.cdk-high-contrast-active .mat-sort-header-pointer-left,.cdk-high-contrast-active .mat-sort-header-pointer-right{width:0;height:0;border-left:solid 6px;border-top:solid 2px}.mat-sort-header-pointer-left{transform-origin:right;left:0}.mat-sort-header-pointer-right{transform-origin:left;right:0}"],encapsulation:2,data:{animation:[U.indicator,U.leftPointer,U.rightPointer,U.arrowOpacity,U.arrowPosition,U.allowChildren]},changeDetection:0})}}return e})();function Ee(e,i){e&1&&(r(0,"p",3),s(1," Actualmente no tienes suscripciones activas. "),n())}function Re(e,i){e&1&&(r(0,"mat-header-cell",16),s(1," Creador "),n())}function Ae(e,i){if(e&1&&(r(0,"mat-cell"),s(1),n()),e&2){let t=i.$implicit;c(),v(" ",t.creatorName," ")}}function Te(e,i){e&1&&(r(0,"mat-header-cell",16),s(1," Fecha de Inicio "),n())}function Ne(e,i){if(e&1&&(r(0,"mat-cell"),s(1),k(2,"date"),n()),e&2){let t=i.$implicit;c(),v(" ",E(2,1,t.startDate)," ")}}function He(e,i){e&1&&(r(0,"mat-header-cell",16),s(1," Fecha de Fin "),n())}function Be(e,i){if(e&1&&(r(0,"mat-cell"),s(1),k(2,"date"),n()),e&2){let t=i.$implicit;c(),v(" ",E(2,1,t.endDate)," ")}}function Fe(e,i){e&1&&(r(0,"mat-header-cell",16),s(1," Plan "),n())}function Le(e,i){if(e&1&&(r(0,"mat-cell"),s(1),n()),e&2){let t=i.$implicit;c(),v(" ",t.planName," ")}}function Ve(e,i){e&1&&(r(0,"mat-header-cell",16),s(1," Estado "),n())}function je(e,i){if(e&1&&(r(0,"mat-cell"),s(1),n()),e&2){let t=i.$implicit;c(),v(" ",t.state," ")}}function Ue(e,i){e&1&&(r(0,"mat-header-cell"),s(1," Acciones "),n())}function ze(e,i){if(e&1){let t=I();r(0,"mat-cell")(1,"button",17),S("click",function(){let a=x(t).$implicit,h=M(2);return y(h.unsuscribe(a.id))}),s(2," Unsubscribe "),n()()}}function $e(e,i){e&1&&p(0,"mat-header-row")}function Ye(e,i){e&1&&p(0,"mat-row")}function Je(e,i){if(e&1&&(r(0,"div")(1,"mat-table",4),_(2,5),d(3,Re,2,0,"mat-header-cell",6)(4,Ae,2,1,"mat-cell",7),g(),_(5,8),d(6,Te,2,0,"mat-header-cell",6)(7,Ne,3,3,"mat-cell",7),g(),_(8,9),d(9,He,2,0,"mat-header-cell",6)(10,Be,3,3,"mat-cell",7),g(),_(11,10),d(12,Fe,2,0,"mat-header-cell",6)(13,Le,2,1,"mat-cell",7),g(),_(14,11),d(15,Ve,2,0,"mat-header-cell",6)(16,je,2,1,"mat-cell",7),g(),_(17,12),d(18,Ue,2,0,"mat-header-cell",13)(19,ze,3,0,"mat-cell",7),g(),d(20,$e,1,0,"mat-header-row",14)(21,Ye,1,0,"mat-row",15),n()()),e&2){let t=M();c(),m("dataSource",t.subscriptions),c(19),m("matHeaderRowDef",t.displayedColumns),c(),m("matRowDefColumns",t.displayedColumns)}}var ft=class e{subscriptions=[];displayedColumns=["creatorName","startDate","endDate","planName","state","actions"];subscriptionService=l(et);snackbar=l(D);ngOnInit(){this.loadSubscriptions()}loadSubscriptions(){let i=localStorage.getItem("profpost_auth"),o=JSON.parse(i).id;this.subscriptionService.getActiveSubscriptions(o).subscribe({next:a=>{this.subscriptions=a},error:a=>{this.snackbar.open("Error al cargar las suscripciones","Cerrar",{duration:3e3})}})}unsuscribe(i){this.subscriptionService.unsuscribe(i).subscribe({next:()=>{this.snackbar.open("Te has desuscrito con \xE9xito, los cambios se ver\xE1n cuando llegues a la fecha de fin","Cerrar",{duration:5e3}),this.loadSubscriptions()},error:()=>{this.snackbar.open("Error al desuscribirse","Cerrar",{duration:3e3})}})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=f({type:e,selectors:[["app-subscriptions"]],standalone:!0,features:[b],decls:5,vars:2,consts:[[1,"subscriptions-container"],["class","no-subscriptions-message",4,"ngIf"],[4,"ngIf"],[1,"no-subscriptions-message"],["matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","creatorName"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","planName"],["matColumnDef","state"],["matColumnDef","actions"],[4,"matHeaderCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],["color","warn",1,"unsubscribe-button",3,"click"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"h2"),s(2,"Mis suscripciones"),n(),d(3,Ee,2,0,"p",1)(4,Je,22,3,"div",2),n()),t&2&&(c(3),m("ngIf",o.subscriptions.length===0),c(),m("ngIf",o.subscriptions.length>0))},dependencies:[nt,xt,at,st,ot,Ce,ct,rt,mt,lt,pt,dt,Q,R],styles:[".subscriptions-container[_ngcontent-%COMP%]{margin:20px auto;max-width:800px;min-height:100vh;padding:20px;background-color:#e5e8d8;border-radius:8px;box-shadow:0 4px 8px #0000001a;text-align:center;justify-content:center}.unsubscribe-button[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;border:none;border-radius:5px;cursor:pointer;width:100%;margin-top:10px;margin-bottom:10px;transition:background-color .3s ease}.unsubscribe-button[_ngcontent-%COMP%]:hover{background-color:#d32f2f!important}mat-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin:20px 0;border:1px solid #999999;border-radius:10px;overflow:hidden;box-shadow:0 4px 8px #0000001a}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:12px;text-align:left;border:1px solid #999999}th[_ngcontent-%COMP%]{background-color:#323f59;color:#fff}td[_ngcontent-%COMP%]{background-color:#fff}.mat-row[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;transition:background-color .3s ease;cursor:pointer}.mat-row[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0003;background-color:#fafafa;transition:all .3s ease;cursor:pointer}"]})};function qe(e,i){e&1&&(r(0,"mat-header-cell"),s(1," ID "),n())}function We(e,i){if(e&1&&(r(0,"mat-cell"),s(1),n()),e&2){let t=i.$implicit;c(),v(" ",t.id," ")}}function Ge(e,i){e&1&&(r(0,"mat-header-cell"),s(1," Total "),n())}function Ke(e,i){if(e&1&&(r(0,"mat-cell"),s(1),k(2,"currency"),n()),e&2){let t=i.$implicit;c(),v(" ",E(2,1,t.total)," ")}}function Qe(e,i){e&1&&(r(0,"mat-header-cell"),s(1," Payment Status "),n())}function Xe(e,i){if(e&1&&(r(0,"mat-cell"),s(1),n()),e&2){let t=i.$implicit;c(),v(" ",t.paymentStatus," ")}}function Ze(e,i){e&1&&(r(0,"mat-header-cell"),s(1," Date "),n())}function ti(e,i){if(e&1&&(r(0,"mat-cell"),s(1),k(2,"date"),n()),e&2){let t=i.$implicit;c(),v(" ",E(2,1,t.createdAt)," ")}}function ei(e,i){e&1&&(r(0,"mat-header-cell"),s(1," Subscription ID "),n())}function ii(e,i){if(e&1&&(r(0,"mat-cell"),s(1),n()),e&2){let t=i.$implicit;c(),v(" ",t.subscriptionId||"N/A"," ")}}function ni(e,i){e&1&&(r(0,"mat-header-cell"),s(1," Donation ID "),n())}function ri(e,i){if(e&1&&(r(0,"mat-cell"),s(1),n()),e&2){let t=i.$implicit;c(),v(" ",t.donationId||"N/A"," ")}}function oi(e,i){e&1&&p(0,"mat-header-row")}function ai(e,i){e&1&&p(0,"mat-row")}var _t=class e{history=[];displayedColumns=["id","total","paymentStatus","createdAt","subscriptionId","donationId"];purchaseService=l(j);snackBar=l(D);authService=l(tt);ngOnInit(){let t=this.authService.getUser()?.id;this.loadHistoryOrders(t)}loadHistoryOrders(i){this.purchaseService.getPurchaseHistoryByUserId(i).subscribe(t=>{this.history=t},t=>{this.showSnackBar("Error al mostrar el historial")})}showSnackBar(i){this.snackBar.open(i,"Cerrar",{duration:3e3})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=f({type:e,selectors:[["app-orders"]],standalone:!0,features:[b],decls:22,vars:3,consts:[[1,"mat-elevation-z8"],[1,"mat-table",3,"dataSource"],["matColumnDef","id"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","total"],["matColumnDef","paymentStatus"],["matColumnDef","createdAt"],["matColumnDef","subscriptionId"],["matColumnDef","donationId"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"mat-table",1),_(2,2),d(3,qe,2,0,"mat-header-cell",3)(4,We,2,1,"mat-cell",4),g(),_(5,5),d(6,Ge,2,0,"mat-header-cell",3)(7,Ke,3,3,"mat-cell",4),g(),_(8,6),d(9,Qe,2,0,"mat-header-cell",3)(10,Xe,2,1,"mat-cell",4),g(),_(11,7),d(12,Ze,2,0,"mat-header-cell",3)(13,ti,3,3,"mat-cell",4),g(),_(14,8),d(15,ei,2,0,"mat-header-cell",3)(16,ii,2,1,"mat-cell",4),g(),_(17,9),d(18,ni,2,0,"mat-header-cell",3)(19,ri,2,1,"mat-cell",4),g(),d(20,oi,1,0,"mat-header-row",10)(21,ai,1,0,"mat-row",11),n()()),t&2&&(c(),m("dataSource",o.history),c(19),m("matHeaderRowDef",o.displayedColumns),c(),m("matRowDefColumns",o.displayedColumns))},dependencies:[nt,st,ot,ct,rt,mt,pt,jt,Q,at,lt,dt],styles:[".mat-table[_ngcontent-%COMP%]{width:100%;margin-top:20px}.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:16px;text-align:center}.mat-column-total[_ngcontent-%COMP%]{text-align:right}.mat-column-paymentStatus[_ngcontent-%COMP%]{text-transform:capitalize}"]})};function si(e,i){if(e&1){let t=I();r(0,"div")(1,"mat-card",5)(2,"mat-card-header")(3,"mat-card-title"),s(4),n()(),r(5,"mat-card-content")(6,"p"),s(7),n(),r(8,"p"),s(9),n()(),p(10,"img",6),k(11,"apiImg"),r(12,"button",7),S("click",function(){let a=x(t).$implicit,h=M(2);return y(h.removePublication(a.id))}),r(13,"span",8),s(14,"delete"),n()()()()}if(e&2){let t=i.$implicit;c(4),K(t.title),c(3),K(t.content),c(2),K(t.video_url),c(),m("src",E(11,5,t.filePath),Et)("alt",t.title)}}function ci(e,i){if(e&1&&(r(0,"div"),d(1,si,15,7,"div",4),n()),e&2){let t=M();c(),m("ngForOf",t.publications)}}function li(e,i){e&1&&(r(0,"p"),s(1,"No hay publicaciones en esta playlist."),n())}var gt=class e{playlistId;publications=[];playlistService=l(it);activatedRoute=l(V);snackBar=l(D);constructor(){}ngOnInit(){this.activatedRoute.params.subscribe(i=>{this.playlistId=+i.id,this.loadPublications()})}loadPublications(){this.playlistService.getPublicationsByPlaylistId(this.playlistId).subscribe(i=>{this.publications=i},i=>{this.snackBar.open("Error al cargar las publicaciones","Cerrar",{duration:3e3}),console.error("Error al cargar las publicaciones:",i)})}removePublication(i){this.playlistService.removePublicationFromPlaylist(this.playlistId,i).subscribe(()=>{this.publications=this.publications.filter(t=>t.id!==i)},t=>{console.error("Error al eliminar la publicaci\xF3n:",t)})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=f({type:e,selectors:[["app-list-publicationsadded"]],standalone:!0,features:[b],decls:7,vars:2,consts:[["noPublications",""],[1,"publications-container"],[1,"publication-list"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[1,"publication-card"],[1,"mat-card-image",3,"src","alt"],[1,"delete-btn",3,"click"],[1,"material-icons"]],template:function(t,o){if(t&1&&(r(0,"div",1)(1,"h2"),s(2,"Publicaciones en la Playlist"),n(),r(3,"div",2),d(4,ci,2,1,"div",3),n(),d(5,li,2,0,"ng-template",null,0,Ft),n()),t&2){let a=$(6);c(4),m("ngIf",o.publications.length>0)("ngIfElse",a)}},dependencies:[L,Vt,R,oe,se,le,ce,ae,ge],styles:[".publications-container[_ngcontent-%COMP%]{max-width:800px;margin:auto;padding:20px;display:flex;flex-direction:column;gap:20px}.publication-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.publication-card[_ngcontent-%COMP%]{width:100%;background-color:#fff;border-radius:10px;box-shadow:0 4px 8px #0003;transition:transform .3s ease;margin-bottom:20px}.publication-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:700;color:#333}mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:.9em;color:#666}mat-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em;line-height:1.5;color:#444}.mat-card-image[_ngcontent-%COMP%]{max-height:400px;max-width:300%;display:block;margin:10px;object-fit:cover;border-radius:10px}button.delete-btn[_ngcontent-%COMP%]{background:none;border:none;color:#f44336;cursor:pointer}button.delete-btn[_ngcontent-%COMP%]:hover{color:#d32f2f}"]})};var or=[{path:"",component:ut,children:[{path:"profile",component:St},{path:"profile/update",component:ue},{path:"profile/:id",component:St},{path:"publications-catalog",component:be},{path:"playlist",component:fe},{path:"playlist/create",component:G},{path:"playlist/edit/:id",component:G},{path:"playlist/:id/publications",component:gt},{path:"subscriptions",component:ft},{path:"subscription",component:pe},{path:"subscription/checkout",component:W},{path:"donation/checkout",component:W},{path:"order/:id",component:_t},{path:"search",component:_e}]}];export{or as readerroutes};
